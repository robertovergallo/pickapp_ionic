<ion-view class="room"><ion-nav-title>Offerta</ion-nav-title><ion-subheader ng-class="{'bar-red': travel_offer.is_applied, 'bar-blue': travel_offer.is_approved }" ng-if="travel_offer.is_applied || travel_offer.is_approved" class="bar bar-subheader"><div class="message"><p ng-if="travel_offer.is_applied">ti sei candidato</p><p ng-if="travel_offer.is_approved">sei stato approvato</p></div></ion-subheader><ion-content ng-class="{'has-subheader': travel_offer.is_applied, 'has-subheader': travel_offer.is_approved}"><ion-refresher pulling-text="Aggiorna ..." on-refresh="pullUpdate()"></ion-refresher><div ng-click="showMapModal()" style="background-image: url(http://maps.googleapis.com/maps/api/staticmap?center={{travel_offer.starting_lat}},{{travel_offer.starting_lng}}9&amp;zoom=16&amp;size=600x300&amp;maptype=roadmap&amp;format=png)" class="room_map"><i class="ion-location"></i><i class="ion-android-open"></i><div class="room_address">{{travel_offer.starting_address}}</div></div><div class="list list-inset"><div ng-click="showProfileDialog(travel_offer.driver.id)" class="item item-avatar"><img src="{{travel_offer.driver.profile_image_url}}"/><h2 ng-if="!travel_offer.driver.surname">{{travel_offer.driver.name}}</h2><h2 ng-if="travel_offer.driver.surname">{{travel_offer.driver.name}} {{travel_offer.driver.surname}} </h2><p>{{travel_offer.departure_datetime | date:"dd MMMM 'alle' HH:mm"}}</p></div><div class="item item-icon-left"><i class="icon ion-ios-flag balanced"></i><b>Da: </b>{{travel_offer.starting_address}}</div><div ng-if="travel_offer.travel_stops.length &gt; 0" ng-click="showTravelStopsModal()" class="item item-icon-left item-icon-right"><i class="icon ion-ios-location-outline positive"></i>Fermate intermedie<i class="icon ion-ios-arrow-right"></i></div><div ng-if="travel_offer.travel_stops.length == 0" class="item item-icon-left"><i class="icon ion-ios-location-outline positive"></i>No Fermate intermedie</div><div class="item item-icon-left"><i class="icon ion-ios-location assertive"></i><b>A: </b>{{travel_offer.room.name}}</div><div class="item item-icon-left"><i class="icon ion-model-s energized"></i><b>{{travel_offer.car.model}} </b>({{travel_offer.car.plate}})</div></div><div style="padding-top: 0px; padding-bottom: 0px;" class="row"><div style="padding-top: 0px; padding-bottom: 0px;" ng-if="!travel_offer.is_applied &amp;&amp; !travel_offer.is_approved &amp;&amp; !travel_offer.is_owner &amp;&amp; checkTravelDate()" class="col"><div ng-click="applyForTravel()" class="button button-block button-positive">Candidati</div></div><div style="padding-top: 0px; padding-bottom: 0px;" class="col"><div ng-click="openChat()" class="button button-block button-energized">Chat Pubblica</div></div></div><div style="padding-top: 0px; padding-bottom: 0px;" ng-show="!travel_offer.has_private_chat &amp;&amp; !travel_offer.is_owner" ng-click="createPrivateChat()" class="row"><div style="padding-top: 0px; padding-bottom: 0px;" class="col"><div class="button button-block button-balanced"> 
Contatta <span>{{travel_offer.driver.name}} {{travel_offer.driver.surname}}</span></div></div></div><div style="padding-top: 0px; padding-bottom: 0px;" ng-show="travel_offer.has_private_chat &amp;&amp; !travel_offer.is_owner" ng-click="getPrivateChat(travel_offer.private_chat_id)" class="row"><div style="padding-top: 0px; padding-bottom: 0px;" class="col"><div class="button button-block button-balanced"> 
Contatta <span>{{travel_offer.driver.name}} {{travel_offer.driver.surname}}</span></div></div></div><div style="padding-top: 0px; padding-bottom: 0px;" ng-if="travel_offer.is_applied &amp;&amp; !travel_offer.is_approved &amp;&amp; !travel_offer.is_owner" class="row"><div style="padding-top: 0px; padding-bottom: 0px;" class="col"><div ng-click="cancelApplicationForTravel()" class="button button-block button-assertive">Annulla candidatura</div></div></div><div ng-if="travel_offer.is_owner &amp;&amp; travel_offer.approved_users.length &gt; 0" class="row"><div class="col"><div class="section_title"><h2>Utenti Accettati ({{travel_offer.approved_count}}/{{travel_offer.available_sits}})</h2></div><div class="list"><div ng-repeat="approved_user in travel_offer.approved_users" ng-click="showProfileDialog(approved_user.user.id)" class="item item-avatar item-icon-right"><img src="{{approved_user.user.profile_image_url}}"/><h2 style="padding-top: 10px">{{approved_user.user.name}} {{approved_user.user.surname}} </h2><i ng-click="cancelApprovalForTravel(approved_user.user.id)" class="icon ion-close-circled assertive"></i></div></div></div></div><div ng-if="travel_offer.is_owner &amp;&amp; travel_offer.applied_users.length &gt; 0" class="row"><div class="col"><div class="section_title"><h2>Utenti Candidati</h2></div><div class="list"><div ng-repeat="applied_user in travel_offer.applied_users" ng-click="showProfileDialog(applied_user.user.id)" class="item item-avatar item-icon-right"><img src="{{applied_user.user.profile_image_url}}"/><h2 style="padding-top: 10px">{{applied_user.user.name}} {{applied_user.user.surname}}</h2><i ng-click="approveForTravel(applied_user.user.id)" ng-if="(travel_offer.available_sits - travel_offer.approved_count) &gt; 0" class="icon ion-checkmark-circled balanced"></i></div></div></div></div><div ng-if="travel_offer.is_owner &amp;&amp; travel_offer.private_chats.length &gt; 0" class="row"><div class="col"><div class="section_title"><h2>Chat Private</h2></div><div class="list"><div ng-repeat="chat in travel_offer.private_chats" class="item item-avatar item-icon-right"><img src="{{chat.passenger.profile_image_url}}"/><h2 style="padding-top: 10px">{{chat.passenger.name}} {{chat.passenger.surname}} </h2><i ng-click="getPrivateChat(chat.id)" class="icon ion-chatbubbles positive"></i></div></div></div></div><div class="row"><div class="col"><div ng-if="travel_offer.is_owner" ng-click="destroyTravel()" class="button button-block button-assertive">Elimina viaggio</div></div></div></ion-content></ion-view>