ion-view.rooms
	ion-nav-title Offerte
	ion-content
		ion-refresher(pulling-text="Aggiorna ..." on-refresh="pullUpdate()")
		.list.card(ng-repeat="offer in room.travels | orderBy:'one_way_datetime'")
			.item.item-avatar
				img(src="{{offer.user.profile_image_url}}")
				h2(ng-if="!offer.user.surname") {{offer.user.name}}
				h2(ng-if="offer.user.surname") {{offer.user.name}} {{offer.user.surname}} 
				p {{offer.departure_datetime | date:"dd MMMM 'alle' HH:mm"}}

			.item.item-icon-left(ng-if="offer.towards_room")
				i.icon.ion-ios-flag-outline.balanced
				b Da: 
				| {{offer.starting_address}}
			.item.item-icon-left(ng-if="!offer.towards_room")
				i.icon.ion-ios-flag-outline.balanced
				b Da: 
				| {{room.name}}

			.item.item-icon-left(ng-if="offer.towards_room")
				i.icon.ion-ios-flag.assertive
				b A: 
				| {{room.name}}
			.item.item-icon-left(ng-if="!offer.towards_room")
				i.icon.ion-ios-flag.assertive
				b A: 
				| {{offer.destination_address}}

			.item.tabs.tabs-secondary.tabs-icon-left
				a.tab-item(ui-sref="app.room_offer({room_id: room.id, travel_id: offer.id})")
					i.icon.ion-eye
					| Dettagli

		.row(ng-if="room.travels.length == 0")
			.col
				p(style="color: #666; font-size: 14px; margin: 20px 0px; text-align: center;") Nessuno offre passaggi verso questa destinazione. Sarai tu il primo?

script(id='chat-modal.html' type='text/ng-template')
	ion-modal-view.map_modal
		ion-header-bar
			h1.title.positive Chat Pubblica
			.buttons
				button.button.button-icon.ion-ios-close-outline.assertive(ng-click="closeChatModal()")
		ion-content.chat(scroll="true")
			.message-wrapper(ng-repeat="message in travel_offer.public_messages | orderBy:'created_at'")
				div(ng-if='!message.is_author')
					img.profile-pic.left(ng-src='{{message.author.profile_image_url}}')
					.chat-bubble.left
						.message(ng-bind-html='message.content | nl2br', autolinker='')
						.message-detail
							span.bold(ng-click='viewProfile(message)' ng-if="message.author.surname") {{message.author.name}} {{message.author.surname}}
							span.bold(ng-click='viewProfile(message)' ng-if="!message.author.surname") {{message.author.name}}

				div(ng-if='message.is_author')
					img.profile-pic.right(ng-click='viewProfile(message)', ng-src='{{user.profile_image_url}}')
					.chat-bubble.right
						.message(ng-bind-html='message.content | nl2br', autolinker='')
						.message-detail
							span.bold(ng-click='viewProfile(message)' ng-if="user.surname") {{user.name}} {{user.surname}}
							span.bold(ng-click='viewProfile(message)' ng-if="!user.surname") {{user.name}}
				
				.cf

		form(name='sendMessageForm' ng-submit='handleMessageNewClick(travel_offer.room.id, travel_offer.id)' novalidate='')
			ion-footer-bar.bar-stable.item-input-inset.message-footer.bar-footer-chat(keyboard-attach='')
				label.item-input-wrapper
					textarea(style="width:100%" ng-model='newTravelOfferMessage.content' value='' placeholder='Messaggio...' required='' minlength='1' maxlength='1500' msd-elastic='')
				.footer-btn-wrap
					button.button.button-icon.icon.ion-android-send.footer-btn(type='submit' ng-disabled="!newTravelOfferMessage.content || newTravelOfferMessage.content === ''")